import{e as $,c as j,b as s,k as me,m as ve,a as l,t as Z,r as w,a5 as pe,g as U,w as z,h as L,u as r,aa as x,f as A,ac as ce,o as fe,P as ge,S as ye,l as F,n as Ce,ae as S,af as we,s as xe}from"./index-Ba5R6kpp.js";import{c as de,a as h,_ as C,b as he,s as re,d as Le,n as be,e as Ne}from"./ErrorMessage-lltwcuir.js";import{s as $e,C as Ve}from"./index-CuSLjwUO.js";const _e=["width","height"],De={__name:"iconFile",props:{size:{type:Number,default:24}},setup(t){return(u,o)=>($(),j("svg",{xmlns:"http://www.w3.org/2000/svg",width:t.size,height:t.size,viewBox:"0 0 12 12",fill:"none"},o[0]||(o[0]=[s("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M2.09467 1.34467C2.23532 1.20402 2.42609 1.125 2.625 1.125H7.125C7.22446 1.125 7.31984 1.16451 7.39016 1.23483L10.0152 3.85984C10.0855 3.93016 10.125 4.02554 10.125 4.125V10.125C10.125 10.3239 10.046 10.5147 9.90533 10.6553C9.76468 10.796 9.57391 10.875 9.375 10.875H2.625C2.42609 10.875 2.23532 10.796 2.09467 10.6553C1.95402 10.5147 1.875 10.3239 1.875 10.125V1.875C1.875 1.67609 1.95402 1.48532 2.09467 1.34467ZM6.96967 1.875L2.625 1.875L2.625 10.125H9.375V4.28033L6.96967 1.875Z",fill:"currentColor"},null,-1),s("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M7.125 1.125C7.33211 1.125 7.5 1.29289 7.5 1.5V3.75H9.75C9.95711 3.75 10.125 3.91789 10.125 4.125C10.125 4.33211 9.95711 4.5 9.75 4.5H7.125C6.91789 4.5 6.75 4.33211 6.75 4.125V1.5C6.75 1.29289 6.91789 1.125 7.125 1.125Z",fill:"currentColor"},null,-1),s("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M4.125 6.375C4.125 6.16789 4.29289 6 4.5 6H7.5C7.70711 6 7.875 6.16789 7.875 6.375C7.875 6.58211 7.70711 6.75 7.5 6.75H4.5C4.29289 6.75 4.125 6.58211 4.125 6.375Z",fill:"currentColor"},null,-1),s("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M4.125 7.875C4.125 7.66789 4.29289 7.5 4.5 7.5H7.5C7.70711 7.5 7.875 7.66789 7.875 7.875C7.875 8.08211 7.70711 8.25 7.5 8.25H4.5C4.29289 8.25 4.125 8.08211 4.125 7.875Z",fill:"currentColor"},null,-1)]),8,_e))}},ke={class:"document-tag gap-2 flex"},Se={class:"document-tag-icon flex items-center justify-center"},ze={class:"document-tag-name"},Ie={__name:"DocumentTag",props:{firstName:String,cardType:{type:String,validator:t=>["residenceCard","driveLicense"].includes(t)}},setup(t){const u=t,o=ve(()=>{const d=u.cardType==="residenceCard"?"Residence Card":"License";return`${u.firstName}'s ${d}`});return(d,c)=>($(),j("div",ke,[s("div",Se,[l(De,{size:12})]),s("div",ze,Z(o.value),1)]))}},ue=me(Ie,[["__scopeId","data-v-106c6e68"]]),qe={class:"flex gap-1 my-5"},Ue={class:"w-1/2"},Ae={class:"flex gap-1 my-5"},Ee={class:"w-1/2"},Me={class:"flex gap-1 my-5"},He={class:"w-1/2"},Pe={class:"flex gap-1 my-5"},Be={class:"w-1/2"},Te={class:"flex gap-1 my-5"},Re={class:"w-1/2"},Fe={class:"flex gap-1 my-5"},Ze={class:"w-1/2"},je={class:"flex gap-1 my-5"},Je={class:"w-1/2"},Oe={class:"flex gap-1 my-5"},We={class:"w-1/2"},Ge={class:"flex gap-1 my-5"},Ke={class:"w-1/2"},Qe={class:"flex gap-1 my-5"},Xe={class:"w-1/2"},Ye={class:"flex gap-1 my-5"},es={class:"w-1/2"},ss={class:"flex gap-1 my-5"},ls={class:"flex gap-1 my-5"},as={class:"flex gap-1 my-5"},ts={class:"w-1/4"},is={class:"flex gap-2 justify-end mt-5 py-3"},ns={__name:"ClientDialog",props:{client:{type:Object,default:()=>({})},showDialog:Boolean},emits:["save","hide"],setup(t,{emit:u}){const o=u,d=w(!1),c=t,v={firstName:"",lastName:"",email:"",phone:"",addressLine1:"",addressLine2:"",city:"",country:"",state:"",zip:"",additional:"",residenceCard:"",driveLicense:"",points:0},i=w({...v}),V=w("Add new client"),D=de({firstName:h().required("First Name is required"),lastName:h().required("Last Name is required"),email:h().email("Invalid email").required("Email is required"),phone:h().required("Phone is required"),addressLine1:h().required("Address Line 1 is required"),addressLine2:h().optional(),city:h().required("City is required"),country:h().required("Country is required"),state:h().required("State is required"),zip:h().required("Zip is required"),additional:h().optional()}),I=()=>{i.value={...v},a.value={}},a=w({});pe(()=>c.showDialog,y=>{V.value=c.client.id?"Edit client":"Add new client",i.value={...c.client},d.value=y});const g=async y=>{try{const e={[y]:i.value[y]};await de({[y]:D.fields[y]}).validate(e),delete a.value[y]}catch(e){a.value[y]=e.message}},R=async()=>{try{a.value={},await D.validate(i.value,{abortEarly:!1}),o("save",i.value),q()}catch(y){y.inner&&y.inner.forEach(e=>{a.value[e.path]=e.message})}},q=()=>{I(),o("hide")},E=()=>{console.log("Uploaded")};return(y,e)=>($(),U(r(Le),{header:V.value,visible:d.value,"onUpdate:visible":[e[24]||(e[24]=_=>d.value=_),q],style:{width:"650px"},modal:!0},{default:z(()=>{var _,H,P,B,b,m,f,p,k,M,J,O,W,G,K,Q,X,Y,ee,se,le,ae,te,ie,ne,oe;return[s("form",{onSubmit:ce(R,["prevent"]),ref:"form"},[s("div",qe,[e[25]||(e[25]=s("div",{class:"flex items-start pt-3 w-1/2"},[s("label",{for:"firstName"},[L("First Name "),s("sup",{class:"text-red-600"},"*")])],-1)),s("div",Ue,[l(r(x),{invalid:!!((_=a.value)!=null&&_.firstName),modelValue:i.value.firstName,"onUpdate:modelValue":e[0]||(e[0]=n=>i.value.firstName=n),onInput:e[1]||(e[1]=n=>g("firstName")),type:"text",id:"firstName",class:"w-full"},null,8,["invalid","modelValue"]),l(C,{message:(H=a.value)==null?void 0:H.firstName},null,8,["message"])])]),s("div",Ae,[e[26]||(e[26]=s("div",{class:"flex items-start pt-3 w-1/2"},[s("label",{for:"lastName"},[L("Last Name "),s("sup",{class:"text-red-600"},"*")])],-1)),s("div",Ee,[l(r(x),{invalid:!!((P=a.value)!=null&&P.lastName),modelValue:i.value.lastName,"onUpdate:modelValue":e[2]||(e[2]=n=>i.value.lastName=n),onInput:e[3]||(e[3]=n=>g("lastName")),type:"text",id:"lastName",class:"w-full"},null,8,["invalid","modelValue"]),l(C,{message:(B=a.value)==null?void 0:B.lastName},null,8,["message"])])]),s("div",Me,[e[27]||(e[27]=s("div",{class:"flex items-start pt-3 w-1/2"},[s("label",{for:"email"},[L("Email "),s("sup",{class:"text-red-600"},"*")])],-1)),s("div",He,[l(r(x),{invalid:!!((b=a.value)!=null&&b.email),modelValue:i.value.email,"onUpdate:modelValue":e[4]||(e[4]=n=>i.value.email=n),onInput:e[5]||(e[5]=n=>g("email")),type:"email",id:"email",class:"w-full"},null,8,["invalid","modelValue"]),l(C,{message:(m=a.value)==null?void 0:m.email},null,8,["message"])])]),s("div",Pe,[e[28]||(e[28]=s("div",{class:"flex items-start pt-3 w-1/2"},[s("label",{for:"phone"},[L("Phone "),s("sup",{class:"text-red-600"},"*")])],-1)),s("div",Be,[l(r(x),{invalid:!!((f=a.value)!=null&&f.phone),modelValue:i.value.phone,"onUpdate:modelValue":e[6]||(e[6]=n=>i.value.phone=n),onInput:e[7]||(e[7]=n=>g("phone")),type:"text",id:"phone",class:"w-full"},null,8,["invalid","modelValue"]),l(C,{message:(p=a.value)==null?void 0:p.phone},null,8,["message"])])]),s("div",Te,[e[29]||(e[29]=s("div",{class:"flex items-start pt-3 w-1/2"},[s("label",{for:"addressLine1"},[L("Address Line 1 "),s("sup",{class:"text-red-600"},"*")])],-1)),s("div",Re,[l(r(x),{invalid:!!((k=a.value)!=null&&k.addressLine1),modelValue:i.value.addressLine1,"onUpdate:modelValue":e[8]||(e[8]=n=>i.value.addressLine1=n),onInput:e[9]||(e[9]=n=>g("addressLine1")),type:"text",id:"addressLine1",class:"w-full"},null,8,["invalid","modelValue"]),l(C,{message:(M=a.value)==null?void 0:M.addressLine1},null,8,["message"])])]),s("div",Fe,[e[30]||(e[30]=s("div",{class:"flex items-start pt-3 w-1/2"},[s("label",{for:"addressLine2"},"Address Line 2")],-1)),s("div",Ze,[l(r(x),{invalid:!!((J=a.value)!=null&&J.addressLine2),modelValue:i.value.addressLine2,"onUpdate:modelValue":e[10]||(e[10]=n=>i.value.addressLine2=n),onInput:e[11]||(e[11]=n=>g("addressLine2")),type:"text",id:"addressLine2",class:"w-full"},null,8,["invalid","modelValue"]),l(C,{message:(O=a.value)==null?void 0:O.addressLine2},null,8,["message"])])]),s("div",je,[e[31]||(e[31]=s("div",{class:"flex items-start pt-3 w-1/2"},[s("label",{for:"city"},[L("City "),s("sup",{class:"text-red-600"},"*")])],-1)),s("div",Je,[l(r(x),{invalid:!!((W=a.value)!=null&&W.city),modelValue:i.value.city,"onUpdate:modelValue":e[12]||(e[12]=n=>i.value.city=n),onInput:e[13]||(e[13]=n=>g("city")),type:"text",id:"city",class:"w-full"},null,8,["invalid","modelValue"]),l(C,{message:(G=a.value)==null?void 0:G.city},null,8,["message"])])]),s("div",Oe,[e[32]||(e[32]=s("div",{class:"flex items-start pt-3 w-1/2"},[s("label",{for:"country"},[L("Country "),s("sup",{class:"text-red-600"},"*")])],-1)),s("div",We,[l(r(x),{invalid:!!((K=a.value)!=null&&K.country),modelValue:i.value.country,"onUpdate:modelValue":e[14]||(e[14]=n=>i.value.country=n),onInput:e[15]||(e[15]=n=>g("country")),type:"text",id:"country",class:"w-full"},null,8,["invalid","modelValue"]),l(C,{message:(Q=a.value)==null?void 0:Q.country},null,8,["message"])])]),s("div",Ge,[e[33]||(e[33]=s("div",{class:"flex items-start pt-3 w-1/2"},[s("label",{for:"state"},[L("State "),s("sup",{class:"text-red-600"},"*")])],-1)),s("div",Ke,[l(r(x),{invalid:!!((X=a.value)!=null&&X.state),modelValue:i.value.state,"onUpdate:modelValue":e[16]||(e[16]=n=>i.value.state=n),onInput:e[17]||(e[17]=n=>g("state")),type:"text",id:"state",class:"w-full"},null,8,["invalid","modelValue"]),l(C,{message:(Y=a.value)==null?void 0:Y.state},null,8,["message"])])]),s("div",Qe,[e[34]||(e[34]=s("div",{class:"flex items-start pt-3 w-1/2"},[s("label",{for:"zip"},[L("Zip "),s("sup",{class:"text-red-600"},"*")])],-1)),s("div",Xe,[l(r(x),{invalid:!!((ee=a.value)!=null&&ee.zip),modelValue:i.value.zip,"onUpdate:modelValue":e[18]||(e[18]=n=>i.value.zip=n),onInput:e[19]||(e[19]=n=>g("zip")),type:"text",id:"zip",class:"w-full"},null,8,["invalid","modelValue"]),l(C,{message:(se=a.value)==null?void 0:se.zip},null,8,["message"])])]),s("div",Ye,[e[35]||(e[35]=s("div",{class:"flex items-start pt-3 w-1/2"},[s("label",{for:"additional"},"Additional info")],-1)),s("div",es,[l(r(he),{invalid:!!((le=a.value)!=null&&le.additional),modelValue:i.value.additional,"onUpdate:modelValue":e[20]||(e[20]=n=>i.value.additional=n),onInput:e[21]||(e[21]=n=>g("additional")),id:"additional",class:"w-full"},null,8,["invalid","modelValue"]),l(C,{message:(ae=a.value)==null?void 0:ae.additional},null,8,["message"])])]),s("div",ss,[e[36]||(e[36]=s("div",{class:"flex items-start pt-3 w-1/2"},[s("label",{for:"residenceCard"},"Residence card")],-1)),s("div",null,[l(r(re),{severity:"secondary",mode:"basic",name:"residenceCard[]",url:"/api/upload",accept:"image/*",maxFileSize:1e6,onUpload:E,auto:!0,chooseLabel:"Browse"}),l(C,{message:(te=a.value)==null?void 0:te.residenceCard},null,8,["message"])])]),s("div",ls,[e[37]||(e[37]=s("div",{class:"flex items-start pt-3 w-1/2"},[s("label",{for:"driveLicense"},"Drive license")],-1)),s("div",null,[l(r(re),{mode:"basic",severity:"secondary",name:"driveLicense[]",url:"/api/upload",accept:"image/*",maxFileSize:1e6,onUpload:E,auto:!0,chooseLabel:"Browse"}),l(C,{message:(ie=a.value)==null?void 0:ie.driveLicense},null,8,["message"])])]),s("div",as,[e[38]||(e[38]=s("div",{class:"flex items-start pt-3 w-1/2"},[s("label",{for:"points"},"Points")],-1)),s("div",ts,[l(r(x),{invalid:!!((ne=a.value)!=null&&ne.points),modelValue:i.value.points,"onUpdate:modelValue":e[22]||(e[22]=n=>i.value.points=n),onInput:e[23]||(e[23]=n=>g("points")),type:"number",id:"points",class:"w-full"},null,8,["invalid","modelValue"]),l(C,{message:(oe=a.value)==null?void 0:oe.points},null,8,["message"])])]),s("div",is,[l(A,{label:"Cancel",onClick:q,outlined:"",severity:"secondary"}),l(A,{label:"Save",type:"submit",severity:"primary",autofocus:""})])],544)]}),_:1},8,["header","visible"]))}},os=[{id:"1",firstName:"Alice",lastName:"Johnson",fullname:"Alice Johnson",email:"alice.johnson@example.com",phone:"123-456-7890",addressLine1:"123 Maple Street",addressLine2:"",city:"",country:"",state:"",zip:"",additional:"",residenceCard:"sample.pdf",driveLicense:"sample2.pdf",points:80},{id:"2",firstName:"Bob",lastName:"Smith",fullname:"Bob Smith",email:"bob.smith@example.com",phone:"234-567-8901",addressLine1:"456 Oak Avenue",addressLine2:"",city:"",country:"",state:"",zip:"",additional:"",residenceCard:"sample.pdf",driveLicense:"",points:120},{id:"3",firstName:"Charlie",lastName:"Davies",fullname:"Charlie Davies",email:"charlie.davis@example.com",phone:"345-678-9012",addressLine1:"789 Pine Road",addressLine2:"",city:"",country:"",state:"",zip:"",additional:"",residenceCard:"",driveLicense:"sample2.pdf",points:150},{id:"4",firstName:"Diana",lastName:"White",fullname:"Diana White",email:"diana.white@example.com",phone:"456-789-0123",addressLine1:"101 Birch Lane",addressLine2:"",city:"",country:"",state:"",zip:"",additional:"",residenceCard:"sample2.pdf",driveLicense:"sample2.pdf",points:50}],N=[...os],T={getClients:async(t={},u=null,o=0,d=5)=>{const c=Math.floor(Math.random()*1001)+500;return new Promise(v=>{setTimeout(()=>{let i=[...N];t!=null&&t.expression&&(i=i.filter(a=>!a.firstName||new RegExp(t==null?void 0:t.expression.toLowerCase(),"i").test(a.firstName.toLowerCase())||!a.lastName||new RegExp(t==null?void 0:t.expression.toLowerCase(),"i").test(a.lastName.toLowerCase())||!a.fullname||new RegExp(t==null?void 0:t.expression.toLowerCase(),"i").test(a.fullname.toLowerCase())||!a.email||new RegExp(t==null?void 0:t.expression.toLowerCase(),"i").test(a.email.toLowerCase())||!a.phone||new RegExp(t==null?void 0:t.expression.toLowerCase(),"i").test(a.phone.toLowerCase())));const V=o===0?0:o*d,D=o===0?d:(o+1)*d,I=i.slice(V,D);v({ok:1,total:i.length,data:I})},c)})},upsertClient:async t=>new Promise(u=>{setTimeout(()=>{const o=N.findIndex(d=>d.id===t.id);if(t.fullname=`${t.firstName} ${t.lastName}`,o!==-1)N[o]={...t},u({ok:1,message:"Client updated successfully",data:N[o]});else{const d={...t,id:be()};u({ok:1,message:"Client added successfully",data:d}),N.push(d)}},500)}),deleteClient:async t=>new Promise(u=>{setTimeout(()=>{const o=N.findIndex(d=>d.id===t);if(o!==-1){const d=N.splice(o,1);u({ok:1,message:"Client deleted successfully",data:d})}else u({ok:0,message:"Client not found"})},500)}),deleteClients:async t=>new Promise(u=>{setTimeout(()=>{if(!Array.isArray(t)){u({ok:0,message:"Invalid input. Please provide an array of IDs."});return}const o=[];t.forEach(d=>{const c=N.findIndex(v=>v.id===d);c!==-1&&o.push(...N.splice(c,1))}),o.length>0?u({ok:1,message:`${o.length} client(s) deleted successfully`,data:o}):u({ok:0,message:"No matching clients found"})},500)})},ds={class:"page page-clients"},rs={class:"page-content"},us={class:"clients-table"},ms={class:"module module-with-scroller module-with-scroller-lg p-1"},vs={class:"page-content-top mb-3 pb-1 flex gap-2 flex-wrap"},ps={class:"text-muted"},cs={class:"flex gap-2"},fs={class:"page-content-bottom"},ws={__name:"ClientsView",setup(t){const u=w(""),o=w(!1),d=w(!1),c=w(null),v=w([]),i=w([]),V=w(8),D=w(0),I=w(0),a=w(!0),g=({page:m,rows:f})=>{I.value=m,V.value=f,b()},R=m=>{u.value=m,b()},q=m=>{c.value=m,d.value=!0},E=()=>{c.value=null,d.value=!1},y=()=>{v!=null&&v.value.length?P():B(c.value),E()},e=m=>{c.value=m,o.value=!0},_=()=>{o.value=!1},H=m=>{T.upsertClient(m),_(),b()},P=()=>{const m=v.value.map(f=>f.id);T.deleteClients(m),v.value=[],b()},B=m=>{const{id:f}=m;T.deleteClient(f),b()},b=async()=>{a.value=!0;try{const m=await T.getClients({expression:u==null?void 0:u.value},null,I.value,V.value);if(!m.ok)throw new Error("Failed to load data");i.value=m.data,D.value=m.total}catch(m){m.value=m.message}finally{a.value=!1}};return fe(()=>{b()}),(m,f)=>($(),j("div",ds,[l(ge,{title:"Clients"}),s("div",rs,[s("div",us,[l(r(xe),null,{content:z(()=>[s("div",ms,[s("div",vs,[l(ye,{variant:"dark",placeholder:"Search for client",onSearchInput:R,filter:u.value},null,8,["filter"]),v.value.length?($(),U(A,{key:0,severity:"secondary",label:"Delete selected",size:"small",class:"ml-auto delete-selected-clients",onClick:q})):F("",!0),l(A,{label:"Add client",severity:"primary",size:"small",onClick:f[0]||(f[0]=p=>e()),class:Ce([v.value.length?"ml-0":"ml-auto","add-new-client"])},null,8,["class"])]),u.value.length&&!i.value.length?($(),U(r($e),{key:0,severity:"secondary",class:"w-full mt-5 mb-5"},{default:z(()=>f[2]||(f[2]=[L("No clients were found matching your criteria.")])),_:1})):($(),U(r(we),{key:1,class:"outlined",scrollable:"",selection:v.value,"onUpdate:selection":f[1]||(f[1]=p=>v.value=p),value:i.value,loading:a.value,tableStyle:"min-width: 50rem"},{default:z(()=>[l(r(S),{selectionMode:"multiple",headerStyle:"width: 3rem"}),l(r(S),{field:"fullname",sortable:"",header:"Client"},{body:z(p=>[s("div",null,Z(p.data.fullname),1),s("span",ps,Z(p.data.email),1)]),_:1}),l(r(S),{field:"phone",sortable:"",header:"Phone"}),l(r(S),{field:"addressLine1",sortable:"",header:"Address"}),l(r(S),{header:"Documents"},{body:z(p=>{var k,M;return[(k=p.data)!=null&&k.residenceCard?($(),U(ue,{key:0,class:"my-1","card-type":"residenceCard",firstName:p.data.firstName},null,8,["firstName"])):F("",!0),(M=p.data)!=null&&M.driveLicense?($(),U(ue,{key:1,class:"my-1","card-type":"driveLicense",firstName:p.data.firstName},null,8,["firstName"])):F("",!0)]}),_:1}),l(r(S),{field:"points",sortable:"",header:"Points"}),l(r(S),{header:"Actions"},{body:z(p=>[s("div",cs,[l(A,{size:"small",label:"Edit",outlined:"",onClick:k=>e(p.data)},null,8,["onClick"]),l(A,{size:"small",label:"Delete",outlined:"",onClick:k=>q(p.data)},null,8,["onClick"])])]),_:1})]),_:1},8,["selection","value","loading"])),s("div",fs,[l(Ve,{limit:V.value,total:D.value,onPageChange:g},null,8,["limit","total"])])])]),_:1})])]),l(Ne,{showDialog:d.value,onApplyConfirmation:y,onHide:E},null,8,["showDialog"]),l(ns,{client:c.value,showDialog:o.value,onSave:H,onHide:_},null,8,["client","showDialog"])]))}};export{ws as default};
