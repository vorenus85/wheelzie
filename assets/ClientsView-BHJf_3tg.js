import{e as V,c as j,b as l,k as me,m as ve,a as s,t as Z,r as C,a5 as pe,g as z,w as A,h as L,u,aa as x,f as q,ac as ce,o as fe,P as ye,S as ge,l as F,n as we,ae as k,af as Ce,s as xe}from"./index-DZRid0Mo.js";import{c as de,a as h,_ as w,b as he,s as re,d as Le,e as be}from"./ErrorMessage-SL-GGWdy.js";import{s as Ne,C as Ve}from"./index-Cna32DtP.js";const $e=["width","height"],_e={__name:"iconFile",props:{size:{type:Number,default:24}},setup(t){return(d,o)=>(V(),j("svg",{xmlns:"http://www.w3.org/2000/svg",width:t.size,height:t.size,viewBox:"0 0 12 12",fill:"none"},o[0]||(o[0]=[l("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M2.09467 1.34467C2.23532 1.20402 2.42609 1.125 2.625 1.125H7.125C7.22446 1.125 7.31984 1.16451 7.39016 1.23483L10.0152 3.85984C10.0855 3.93016 10.125 4.02554 10.125 4.125V10.125C10.125 10.3239 10.046 10.5147 9.90533 10.6553C9.76468 10.796 9.57391 10.875 9.375 10.875H2.625C2.42609 10.875 2.23532 10.796 2.09467 10.6553C1.95402 10.5147 1.875 10.3239 1.875 10.125V1.875C1.875 1.67609 1.95402 1.48532 2.09467 1.34467ZM6.96967 1.875L2.625 1.875L2.625 10.125H9.375V4.28033L6.96967 1.875Z",fill:"currentColor"},null,-1),l("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M7.125 1.125C7.33211 1.125 7.5 1.29289 7.5 1.5V3.75H9.75C9.95711 3.75 10.125 3.91789 10.125 4.125C10.125 4.33211 9.95711 4.5 9.75 4.5H7.125C6.91789 4.5 6.75 4.33211 6.75 4.125V1.5C6.75 1.29289 6.91789 1.125 7.125 1.125Z",fill:"currentColor"},null,-1),l("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M4.125 6.375C4.125 6.16789 4.29289 6 4.5 6H7.5C7.70711 6 7.875 6.16789 7.875 6.375C7.875 6.58211 7.70711 6.75 7.5 6.75H4.5C4.29289 6.75 4.125 6.58211 4.125 6.375Z",fill:"currentColor"},null,-1),l("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M4.125 7.875C4.125 7.66789 4.29289 7.5 4.5 7.5H7.5C7.70711 7.5 7.875 7.66789 7.875 7.875C7.875 8.08211 7.70711 8.25 7.5 8.25H4.5C4.29289 8.25 4.125 8.08211 4.125 7.875Z",fill:"currentColor"},null,-1)]),8,$e))}},De={class:"document-tag gap-2 flex"},Se={class:"document-tag-icon flex items-center justify-center"},ke={class:"document-tag-name"},Ae={__name:"DocumentTag",props:{firstName:String,cardType:{type:String,validator:t=>["residenceCard","driveLicense"].includes(t)}},setup(t){const d=t,o=ve(()=>{const r=d.cardType==="residenceCard"?"Residence Card":"License";return`${d.firstName}'s ${r}`});return(r,c)=>(V(),j("div",De,[l("div",Se,[s(_e,{size:12})]),l("div",ke,Z(o.value),1)]))}},ue=me(Ae,[["__scopeId","data-v-106c6e68"]]),Ie={class:"flex gap-1 my-5"},Ue={class:"w-1/2"},ze={class:"flex gap-1 my-5"},qe={class:"w-1/2"},Ee={class:"flex gap-1 my-5"},Me={class:"w-1/2"},Pe={class:"flex gap-1 my-5"},Be={class:"w-1/2"},He={class:"flex gap-1 my-5"},Re={class:"w-1/2"},Te={class:"flex gap-1 my-5"},Fe={class:"w-1/2"},Ze={class:"flex gap-1 my-5"},je={class:"w-1/2"},Je={class:"flex gap-1 my-5"},Oe={class:"w-1/2"},We={class:"flex gap-1 my-5"},Ye={class:"w-1/2"},Ge={class:"flex gap-1 my-5"},Ke={class:"w-1/2"},Qe={class:"flex gap-1 my-5"},Xe={class:"w-1/2"},el={class:"flex gap-1 my-5"},ll={class:"flex gap-1 my-5"},sl={class:"flex gap-1 my-5"},al={class:"w-1/4"},tl={class:"flex gap-2 justify-end mt-5 py-3"},il={__name:"ClientDialog",props:{client:{type:Object,default:()=>({})},showDialog:Boolean},emits:["save","hide"],setup(t,{emit:d}){const o=d,r=C(!1),c=t,v={firstName:"",lastName:"",email:"",phone:"",addressLine1:"",addressLine2:"",city:"",country:"",state:"",zip:"",additional:"",residenceCard:"",driveLicense:"",points:0},i=C({...v}),$=C("Add new client"),D=de({firstName:h().required("First Name is required"),lastName:h().required("Last Name is required"),email:h().email("Invalid email").required("Email is required"),phone:h().required("Phone is required"),addressLine1:h().required("Address Line 1 is required"),addressLine2:h().optional(),city:h().required("City is required"),country:h().required("Country is required"),state:h().required("State is required"),zip:h().required("Zip is required"),additional:h().optional()}),I=()=>{i.value={...v},a.value={}},a=C({});pe(()=>c.showDialog,g=>{$.value=c.client.id?"Edit client":"Add new client",i.value={...c.client},r.value=g});const y=async g=>{try{const e={[g]:i.value[g]};await de({[g]:D.fields[g]}).validate(e),delete a.value[g]}catch(e){a.value[g]=e.message}},T=async()=>{try{a.value={},await D.validate(i.value,{abortEarly:!1}),o("save",i.value),U()}catch(g){g.inner&&g.inner.forEach(e=>{a.value[e.path]=e.message})}},U=()=>{I(),o("hide")},E=()=>{console.log("Uploaded")};return(g,e)=>(V(),z(u(Le),{header:$.value,visible:r.value,"onUpdate:visible":[e[24]||(e[24]=_=>r.value=_),U],style:{width:"650px"},modal:!0},{default:A(()=>{var _,P,B,H,b,m,f,p,S,M,J,O,W,Y,G,K,Q,X,ee,le,se,ae,te,ie,ne,oe;return[l("form",{onSubmit:ce(T,["prevent"]),ref:"form"},[l("div",Ie,[e[25]||(e[25]=l("div",{class:"flex items-start pt-3 w-1/2"},[l("label",{for:"firstName"},[L("First Name "),l("sup",{class:"text-red-600"},"*")])],-1)),l("div",Ue,[s(u(x),{invalid:!!((_=a.value)!=null&&_.firstName),modelValue:i.value.firstName,"onUpdate:modelValue":e[0]||(e[0]=n=>i.value.firstName=n),onInput:e[1]||(e[1]=n=>y("firstName")),type:"text",id:"firstName",class:"w-full"},null,8,["invalid","modelValue"]),s(w,{message:(P=a.value)==null?void 0:P.firstName},null,8,["message"])])]),l("div",ze,[e[26]||(e[26]=l("div",{class:"flex items-start pt-3 w-1/2"},[l("label",{for:"lastName"},[L("Last Name "),l("sup",{class:"text-red-600"},"*")])],-1)),l("div",qe,[s(u(x),{invalid:!!((B=a.value)!=null&&B.lastName),modelValue:i.value.lastName,"onUpdate:modelValue":e[2]||(e[2]=n=>i.value.lastName=n),onInput:e[3]||(e[3]=n=>y("lastName")),type:"text",id:"lastName",class:"w-full"},null,8,["invalid","modelValue"]),s(w,{message:(H=a.value)==null?void 0:H.lastName},null,8,["message"])])]),l("div",Ee,[e[27]||(e[27]=l("div",{class:"flex items-start pt-3 w-1/2"},[l("label",{for:"email"},[L("Email "),l("sup",{class:"text-red-600"},"*")])],-1)),l("div",Me,[s(u(x),{invalid:!!((b=a.value)!=null&&b.email),modelValue:i.value.email,"onUpdate:modelValue":e[4]||(e[4]=n=>i.value.email=n),onInput:e[5]||(e[5]=n=>y("email")),type:"email",id:"email",class:"w-full"},null,8,["invalid","modelValue"]),s(w,{message:(m=a.value)==null?void 0:m.email},null,8,["message"])])]),l("div",Pe,[e[28]||(e[28]=l("div",{class:"flex items-start pt-3 w-1/2"},[l("label",{for:"phone"},[L("Phone "),l("sup",{class:"text-red-600"},"*")])],-1)),l("div",Be,[s(u(x),{invalid:!!((f=a.value)!=null&&f.phone),modelValue:i.value.phone,"onUpdate:modelValue":e[6]||(e[6]=n=>i.value.phone=n),onInput:e[7]||(e[7]=n=>y("phone")),type:"text",id:"phone",class:"w-full"},null,8,["invalid","modelValue"]),s(w,{message:(p=a.value)==null?void 0:p.phone},null,8,["message"])])]),l("div",He,[e[29]||(e[29]=l("div",{class:"flex items-start pt-3 w-1/2"},[l("label",{for:"addressLine1"},[L("Address Line 1 "),l("sup",{class:"text-red-600"},"*")])],-1)),l("div",Re,[s(u(x),{invalid:!!((S=a.value)!=null&&S.addressLine1),modelValue:i.value.addressLine1,"onUpdate:modelValue":e[8]||(e[8]=n=>i.value.addressLine1=n),onInput:e[9]||(e[9]=n=>y("addressLine1")),type:"text",id:"addressLine1",class:"w-full"},null,8,["invalid","modelValue"]),s(w,{message:(M=a.value)==null?void 0:M.addressLine1},null,8,["message"])])]),l("div",Te,[e[30]||(e[30]=l("div",{class:"flex items-start pt-3 w-1/2"},[l("label",{for:"addressLine2"},"Address Line 2")],-1)),l("div",Fe,[s(u(x),{invalid:!!((J=a.value)!=null&&J.addressLine2),modelValue:i.value.addressLine2,"onUpdate:modelValue":e[10]||(e[10]=n=>i.value.addressLine2=n),onInput:e[11]||(e[11]=n=>y("addressLine2")),type:"text",id:"addressLine2",class:"w-full"},null,8,["invalid","modelValue"]),s(w,{message:(O=a.value)==null?void 0:O.addressLine2},null,8,["message"])])]),l("div",Ze,[e[31]||(e[31]=l("div",{class:"flex items-start pt-3 w-1/2"},[l("label",{for:"city"},[L("City "),l("sup",{class:"text-red-600"},"*")])],-1)),l("div",je,[s(u(x),{invalid:!!((W=a.value)!=null&&W.city),modelValue:i.value.city,"onUpdate:modelValue":e[12]||(e[12]=n=>i.value.city=n),onInput:e[13]||(e[13]=n=>y("city")),type:"text",id:"city",class:"w-full"},null,8,["invalid","modelValue"]),s(w,{message:(Y=a.value)==null?void 0:Y.city},null,8,["message"])])]),l("div",Je,[e[32]||(e[32]=l("div",{class:"flex items-start pt-3 w-1/2"},[l("label",{for:"country"},[L("Country "),l("sup",{class:"text-red-600"},"*")])],-1)),l("div",Oe,[s(u(x),{invalid:!!((G=a.value)!=null&&G.country),modelValue:i.value.country,"onUpdate:modelValue":e[14]||(e[14]=n=>i.value.country=n),onInput:e[15]||(e[15]=n=>y("country")),type:"text",id:"country",class:"w-full"},null,8,["invalid","modelValue"]),s(w,{message:(K=a.value)==null?void 0:K.country},null,8,["message"])])]),l("div",We,[e[33]||(e[33]=l("div",{class:"flex items-start pt-3 w-1/2"},[l("label",{for:"state"},[L("State "),l("sup",{class:"text-red-600"},"*")])],-1)),l("div",Ye,[s(u(x),{invalid:!!((Q=a.value)!=null&&Q.state),modelValue:i.value.state,"onUpdate:modelValue":e[16]||(e[16]=n=>i.value.state=n),onInput:e[17]||(e[17]=n=>y("state")),type:"text",id:"state",class:"w-full"},null,8,["invalid","modelValue"]),s(w,{message:(X=a.value)==null?void 0:X.state},null,8,["message"])])]),l("div",Ge,[e[34]||(e[34]=l("div",{class:"flex items-start pt-3 w-1/2"},[l("label",{for:"zip"},[L("Zip "),l("sup",{class:"text-red-600"},"*")])],-1)),l("div",Ke,[s(u(x),{invalid:!!((ee=a.value)!=null&&ee.zip),modelValue:i.value.zip,"onUpdate:modelValue":e[18]||(e[18]=n=>i.value.zip=n),onInput:e[19]||(e[19]=n=>y("zip")),type:"text",id:"zip",class:"w-full"},null,8,["invalid","modelValue"]),s(w,{message:(le=a.value)==null?void 0:le.zip},null,8,["message"])])]),l("div",Qe,[e[35]||(e[35]=l("div",{class:"flex items-start pt-3 w-1/2"},[l("label",{for:"additional"},"Additional info")],-1)),l("div",Xe,[s(u(he),{invalid:!!((se=a.value)!=null&&se.additional),modelValue:i.value.additional,"onUpdate:modelValue":e[20]||(e[20]=n=>i.value.additional=n),onInput:e[21]||(e[21]=n=>y("additional")),id:"additional",class:"w-full"},null,8,["invalid","modelValue"]),s(w,{message:(ae=a.value)==null?void 0:ae.additional},null,8,["message"])])]),l("div",el,[e[36]||(e[36]=l("div",{class:"flex items-start pt-3 w-1/2"},[l("label",{for:"residenceCard"},"Residence card")],-1)),l("div",null,[s(u(re),{severity:"secondary",mode:"basic",name:"residenceCard[]",url:"/api/upload",accept:"image/*",maxFileSize:1e6,onUpload:E,auto:!0,chooseLabel:"Browse"}),s(w,{message:(te=a.value)==null?void 0:te.residenceCard},null,8,["message"])])]),l("div",ll,[e[37]||(e[37]=l("div",{class:"flex items-start pt-3 w-1/2"},[l("label",{for:"driveLicense"},"Drive license")],-1)),l("div",null,[s(u(re),{mode:"basic",severity:"secondary",name:"driveLicense[]",url:"/api/upload",accept:"image/*",maxFileSize:1e6,onUpload:E,auto:!0,chooseLabel:"Browse"}),s(w,{message:(ie=a.value)==null?void 0:ie.driveLicense},null,8,["message"])])]),l("div",sl,[e[38]||(e[38]=l("div",{class:"flex items-start pt-3 w-1/2"},[l("label",{for:"points"},"Points")],-1)),l("div",al,[s(u(x),{invalid:!!((ne=a.value)!=null&&ne.points),modelValue:i.value.points,"onUpdate:modelValue":e[22]||(e[22]=n=>i.value.points=n),onInput:e[23]||(e[23]=n=>y("points")),type:"number",id:"points",class:"w-full"},null,8,["invalid","modelValue"]),s(w,{message:(oe=a.value)==null?void 0:oe.points},null,8,["message"])])]),l("div",tl,[s(q,{label:"Cancel",onClick:U,outlined:"",severity:"secondary"}),s(q,{label:"Save",type:"submit",severity:"primary",autofocus:""})])],544)]}),_:1},8,["header","visible"]))}},nl="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let ol=(t=21)=>{let d="",o=crypto.getRandomValues(new Uint8Array(t|=0));for(;t--;)d+=nl[o[t]&63];return d};const dl=[{id:"1",firstName:"Alice",lastName:"Johnson",fullname:"Alice Johnson",email:"alice.johnson@example.com",phone:"123-456-7890",addressLine1:"123 Maple Street",addressLine2:"",city:"New York",country:"USA",state:"NY",zip:"10001",additional:"",residenceCard:"sample.pdf",driveLicense:"sample2.pdf",points:80},{id:"2",firstName:"Bob",lastName:"Smith",fullname:"Bob Smith",email:"bob.smith@example.com",phone:"234-567-8901",addressLine1:"456 Oak Avenue",addressLine2:"",city:"Boston",country:"USA",state:"MA",zip:"02108",additional:"",residenceCard:"sample.pdf",driveLicense:"",points:120},{id:"3",firstName:"Charlie",lastName:"Davies",fullname:"Charlie Davies",email:"charlie.davis@example.com",phone:"345-678-9012",addressLine1:"789 Pine Road",addressLine2:"",city:"Philadelphia",country:"USA",state:"PA",zip:"19103",additional:"",residenceCard:"",driveLicense:"sample2.pdf",points:150},{id:"4",firstName:"Diana",lastName:"White",fullname:"Diana White",email:"diana.white@example.com",phone:"456-789-0123",addressLine1:"101 Birch Lane",addressLine2:"",city:"Baltimore",country:"USA",state:"MD",zip:"21201",additional:"",residenceCard:"sample2.pdf",driveLicense:"sample2.pdf",points:50}],N=[...dl],R={getClients:async(t={},d=null,o=0,r=5)=>{const c=Math.floor(Math.random()*1001)+500;return new Promise(v=>{setTimeout(()=>{let i=[...N];t!=null&&t.expression&&(i=i.filter(a=>!a.firstName||new RegExp(t==null?void 0:t.expression.toLowerCase(),"i").test(a.firstName.toLowerCase())||!a.lastName||new RegExp(t==null?void 0:t.expression.toLowerCase(),"i").test(a.lastName.toLowerCase())||!a.fullname||new RegExp(t==null?void 0:t.expression.toLowerCase(),"i").test(a.fullname.toLowerCase())||!a.email||new RegExp(t==null?void 0:t.expression.toLowerCase(),"i").test(a.email.toLowerCase())||!a.phone||new RegExp(t==null?void 0:t.expression.toLowerCase(),"i").test(a.phone.toLowerCase())));const $=o===0?0:o*r,D=o===0?r:(o+1)*r,I=i.slice($,D);v({ok:1,total:i.length,data:I})},c)})},upsertClient:async t=>new Promise(d=>{setTimeout(()=>{const o=N.findIndex(r=>r.id===t.id);if(t.fullname=`${t.firstName} ${t.lastName}`,o!==-1)N[o]={...t},d({ok:1,message:"Client updated successfully",data:N[o]});else{const r={...t,id:ol()};d({ok:1,message:"Client added successfully",data:r}),N.push(r)}},500)}),deleteClient:async t=>new Promise(d=>{setTimeout(()=>{const o=N.findIndex(r=>r.id===t);if(o!==-1){const r=N.splice(o,1);d({ok:1,message:"Client deleted successfully",data:r})}else d({ok:0,message:"Client not found"})},500)}),deleteClients:async t=>new Promise(d=>{setTimeout(()=>{if(!Array.isArray(t)){d({ok:0,message:"Invalid input. Please provide an array of IDs."});return}const o=[];t.forEach(r=>{const c=N.findIndex(v=>v.id===r);c!==-1&&o.push(...N.splice(c,1))}),o.length>0?d({ok:1,message:`${o.length} client(s) deleted successfully`,data:o}):d({ok:0,message:"No matching clients found"})},500)})},rl={class:"page page-clients"},ul={class:"page-content"},ml={class:"clients-table"},vl={class:"module module-with-scroller module-with-scroller-lg p-1"},pl={class:"page-content-top mb-3 pb-1 flex gap-2 flex-wrap"},cl={class:"text-muted"},fl={class:"flex gap-2"},yl={class:"page-content-bottom"},xl={__name:"ClientsView",setup(t){const d=C(""),o=C(!1),r=C(!1),c=C(null),v=C([]),i=C([]),$=C(8),D=C(0),I=C(0),a=C(!0),y=({page:m,rows:f})=>{I.value=m,$.value=f,b()},T=m=>{d.value=m,b()},U=m=>{c.value=m,r.value=!0},E=()=>{c.value=null,r.value=!1},g=()=>{v!=null&&v.value.length?B():H(c.value),E()},e=m=>{c.value=m,o.value=!0},_=()=>{o.value=!1},P=m=>{R.upsertClient(m),_(),b()},B=()=>{const m=v.value.map(f=>f.id);R.deleteClients(m),v.value=[],b()},H=m=>{const{id:f}=m;R.deleteClient(f),b()},b=async()=>{a.value=!0;try{const m=await R.getClients({expression:d==null?void 0:d.value},null,I.value,$.value);if(!m.ok)throw new Error("Failed to load data");i.value=m.data,D.value=m.total}catch(m){m.value=m.message}finally{a.value=!1}};return fe(()=>{b()}),(m,f)=>(V(),j("div",rl,[s(ye,{title:"Clients"}),l("div",ul,[l("div",ml,[s(u(xe),null,{content:A(()=>[l("div",vl,[l("div",pl,[s(ge,{variant:"dark",placeholder:"Search for client",onSearchInput:T,filter:d.value},null,8,["filter"]),v.value.length?(V(),z(q,{key:0,severity:"secondary",label:"Delete selected",size:"small",class:"ml-auto delete-selected-clients",onClick:U})):F("",!0),s(q,{label:"Add client",severity:"primary",size:"small",onClick:f[0]||(f[0]=p=>e()),class:we([v.value.length?"ml-0":"ml-auto","add-new-client"])},null,8,["class"])]),d.value.length&&!i.value.length?(V(),z(u(Ne),{key:0,severity:"secondary",class:"w-full mt-5 mb-5"},{default:A(()=>f[2]||(f[2]=[L("No clients were found matching your criteria.")])),_:1})):(V(),z(u(Ce),{key:1,class:"outlined",scrollable:"",selection:v.value,"onUpdate:selection":f[1]||(f[1]=p=>v.value=p),value:i.value,loading:a.value,tableStyle:"min-width: 50rem"},{default:A(()=>[s(u(k),{selectionMode:"multiple",headerStyle:"width: 3rem"}),s(u(k),{field:"fullname",sortable:"",header:"Client"},{body:A(p=>[l("div",null,Z(p.data.fullname),1),l("span",cl,Z(p.data.email),1)]),_:1}),s(u(k),{field:"phone",sortable:"",header:"Phone"}),s(u(k),{field:"addressLine1",sortable:"",header:"Address"}),s(u(k),{header:"Documents"},{body:A(p=>{var S,M;return[(S=p.data)!=null&&S.residenceCard?(V(),z(ue,{key:0,class:"my-1","card-type":"residenceCard",firstName:p.data.firstName},null,8,["firstName"])):F("",!0),(M=p.data)!=null&&M.driveLicense?(V(),z(ue,{key:1,class:"my-1","card-type":"driveLicense",firstName:p.data.firstName},null,8,["firstName"])):F("",!0)]}),_:1}),s(u(k),{field:"points",sortable:"",header:"Points"}),s(u(k),{header:"Actions"},{body:A(p=>[l("div",fl,[s(q,{size:"small",label:"Edit",outlined:"",onClick:S=>e(p.data)},null,8,["onClick"]),s(q,{size:"small",label:"Delete",outlined:"",onClick:S=>U(p.data)},null,8,["onClick"])])]),_:1})]),_:1},8,["selection","value","loading"])),l("div",yl,[s(Ve,{limit:$.value,total:D.value,onPageChange:y},null,8,["limit","total"])])])]),_:1})])]),s(be,{showDialog:r.value,onApplyConfirmation:g,onHide:E},null,8,["showDialog"]),s(il,{client:c.value,showDialog:o.value,onSave:P,onHide:_},null,8,["client","showDialog"])]))}};export{xl as default};
