import{o as _,c as T,a as l,ai as ve,ak as R,I as s,N as Z,D as me,S as g,V as ce,z as k,J as D,P as V,W as n,p as x,a0 as I,a1 as pe,a3 as fe,a5 as ge,a6 as ye,E as j,A as Ce,al as N,am as we,a9 as xe}from"./index-kdTA1ue6.js";import{s as be,a as de,_ as Ve}from"./ConfirmDialog-XI9K8tS0.js";import{c as re,a as b,_ as f,s as _e,b as $e}from"./ErrorMessage-pnXlQg_d.js";import{C as he}from"./CustomPagination-BCxbwSky.js";import{c as F}from"./clients-CXiavMjk.js";const Le=["width","height"],Ne={__name:"iconFile",props:{size:{type:Number,default:24}},setup(w){return(u,m)=>(_(),T("svg",{xmlns:"http://www.w3.org/2000/svg",width:w.size,height:w.size,viewBox:"0 0 12 12",fill:"none"},m[0]||(m[0]=[l("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M2.09467 1.34467C2.23532 1.20402 2.42609 1.125 2.625 1.125H7.125C7.22446 1.125 7.31984 1.16451 7.39016 1.23483L10.0152 3.85984C10.0855 3.93016 10.125 4.02554 10.125 4.125V10.125C10.125 10.3239 10.046 10.5147 9.90533 10.6553C9.76468 10.796 9.57391 10.875 9.375 10.875H2.625C2.42609 10.875 2.23532 10.796 2.09467 10.6553C1.95402 10.5147 1.875 10.3239 1.875 10.125V1.875C1.875 1.67609 1.95402 1.48532 2.09467 1.34467ZM6.96967 1.875L2.625 1.875L2.625 10.125H9.375V4.28033L6.96967 1.875Z",fill:"currentColor"},null,-1),l("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M7.125 1.125C7.33211 1.125 7.5 1.29289 7.5 1.5V3.75H9.75C9.95711 3.75 10.125 3.91789 10.125 4.125C10.125 4.33211 9.95711 4.5 9.75 4.5H7.125C6.91789 4.5 6.75 4.33211 6.75 4.125V1.5C6.75 1.29289 6.91789 1.125 7.125 1.125Z",fill:"currentColor"},null,-1),l("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M4.125 6.375C4.125 6.16789 4.29289 6 4.5 6H7.5C7.70711 6 7.875 6.16789 7.875 6.375C7.875 6.58211 7.70711 6.75 7.5 6.75H4.5C4.29289 6.75 4.125 6.58211 4.125 6.375Z",fill:"currentColor"},null,-1),l("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M4.125 7.875C4.125 7.66789 4.29289 7.5 4.5 7.5H7.5C7.70711 7.5 7.875 7.66789 7.875 7.875C7.875 8.08211 7.70711 8.25 7.5 8.25H4.5C4.29289 8.25 4.125 8.08211 4.125 7.875Z",fill:"currentColor"},null,-1)]),8,Le))}},De={class:"document-tag gap-2 flex"},Se={class:"document-tag-icon flex items-center justify-center"},ze={class:"document-tag-name"},ke={__name:"DocumentTag",props:{firstName:String,cardType:{type:String,validator:w=>["residenceCard","driveLicense"].includes(w)}},setup(w){const u=w,m=R(()=>{const y=u.cardType==="residenceCard"?"Residence Card":"License";return`${u.firstName}'s ${y}`});return(y,C)=>(_(),T("div",De,[l("div",Se,[s(Ne,{size:12})]),l("div",ze,Z(m.value),1)]))}},ue=ve(ke,[["__scopeId","data-v-106c6e68"]]),Ie={__name:"MonogramBadge",props:{name:String},setup(w){const u=w,m=["#780000","#C1121F","#3d405b","#003049","#669BBC","#52796f","#6a994e","#252422"],y=R(()=>{const d=u.name;if(d.length)return d.length<1?"":d.length===1?d[0].split("")[0]:d[0].split("")[0]+d[1].split("")[0]}),C=R(()=>m[Math.floor(Math.random()*m.length)]);return(d,i)=>(_(),T("div",{class:"name-badge mr-5",style:me({backgroundColor:C.value})},Z(y.value),5))}},qe=ve(Ie,[["__scopeId","data-v-e828795f"]]),Ue={class:"flex gap-1 my-5"},Me={class:"w-1/2"},Ae={class:"flex gap-1 my-5"},Be={class:"w-1/2"},He={class:"flex gap-1 my-5"},Ee={class:"w-1/2"},Fe={class:"flex gap-1 my-5"},Ze={class:"w-1/2"},Te={class:"flex gap-1 my-5"},Pe={class:"w-1/2"},je={class:"flex gap-1 my-5"},Re={class:"w-1/2"},Je={class:"flex gap-1 my-5"},Oe={class:"w-1/2"},We={class:"flex gap-1 my-5"},Ge={class:"w-1/2"},Ke={class:"flex gap-1 my-5"},Qe={class:"w-1/2"},Xe={class:"flex gap-1 my-5"},Ye={class:"w-1/2"},el={class:"flex gap-1 my-5"},ll={class:"w-1/2"},sl={class:"flex gap-1 my-5"},al={class:"flex gap-1 my-5"},tl={class:"flex gap-1 my-5"},il={class:"w-1/4"},nl={class:"flex gap-2 justify-end mt-5 py-3"},ol={__name:"ClientDialog",props:{client:{type:Object,default:()=>({})},showDialog:Boolean},emits:["save","hide"],setup(w,{emit:u}){const m=u,y=g(!1),C=w,d={firstName:"",lastName:"",email:"",phone:"",addressLine1:"",addressLine2:"",city:"",country:"",state:"",zip:"",additional:"",residenceCard:"",driveLicense:"",points:0},i=g({...d}),S=g("Add new client"),q=re({firstName:b().required("First Name is required"),lastName:b().required("Last Name is required"),email:b().email("Invalid email").required("Email is required"),phone:b().required("Phone is required"),addressLine1:b().required("Address Line 1 is required"),addressLine2:b().optional(),city:b().required("City is required"),country:b().required("Country is required"),state:b().required("State is required"),zip:b().required("Zip is required"),additional:b().optional()}),A=()=>{i.value={...d},a.value={}},a=g({});ce(()=>C.showDialog,p=>{S.value=C.client.id?"Edit client":"Add new client",i.value={...C.client},y.value=p});const c=async p=>{try{const e={[p]:i.value[p]};await re({[p]:q.fields[p]}).validate(e),delete a.value[p]}catch(e){a.value[p]=e.message}},P=async()=>{try{a.value={},await q.validate(i.value,{abortEarly:!1}),m("save",i.value),z()}catch(p){p.inner&&p.inner.forEach(e=>{a.value[e.path]=e.message})}},z=()=>{A(),m("hide")},U=()=>{console.log("Uploaded")};return(p,e)=>(_(),k(n(_e),{header:S.value,visible:y.value,"onUpdate:visible":[e[24]||(e[24]=h=>y.value=h),z],style:{width:"650px"},modal:!0},{default:D(()=>{var h,B,H,E,$,o,v,r,L,M,J,O,W,G,K,Q,X,Y,ee,le,se,ae,te,ie,ne,oe;return[l("form",{onSubmit:pe(P,["prevent"]),ref:"form"},[l("div",Ue,[e[25]||(e[25]=l("div",{class:"flex items-start pt-3 w-1/2"},[l("label",{for:"firstName"},[V("First Name "),l("sup",{class:"text-red-600"},"*")])],-1)),l("div",Me,[s(n(x),{invalid:!!((h=a.value)!=null&&h.firstName),modelValue:i.value.firstName,"onUpdate:modelValue":e[0]||(e[0]=t=>i.value.firstName=t),onInput:e[1]||(e[1]=t=>c("firstName")),type:"text",id:"firstName",class:"w-full"},null,8,["invalid","modelValue"]),s(f,{message:(B=a.value)==null?void 0:B.firstName},null,8,["message"])])]),l("div",Ae,[e[26]||(e[26]=l("div",{class:"flex items-start pt-3 w-1/2"},[l("label",{for:"lastName"},[V("Last Name "),l("sup",{class:"text-red-600"},"*")])],-1)),l("div",Be,[s(n(x),{invalid:!!((H=a.value)!=null&&H.lastName),modelValue:i.value.lastName,"onUpdate:modelValue":e[2]||(e[2]=t=>i.value.lastName=t),onInput:e[3]||(e[3]=t=>c("lastName")),type:"text",id:"lastName",class:"w-full"},null,8,["invalid","modelValue"]),s(f,{message:(E=a.value)==null?void 0:E.lastName},null,8,["message"])])]),l("div",He,[e[27]||(e[27]=l("div",{class:"flex items-start pt-3 w-1/2"},[l("label",{for:"email"},[V("Email "),l("sup",{class:"text-red-600"},"*")])],-1)),l("div",Ee,[s(n(x),{invalid:!!(($=a.value)!=null&&$.email),modelValue:i.value.email,"onUpdate:modelValue":e[4]||(e[4]=t=>i.value.email=t),onInput:e[5]||(e[5]=t=>c("email")),type:"email",id:"email",class:"w-full"},null,8,["invalid","modelValue"]),s(f,{message:(o=a.value)==null?void 0:o.email},null,8,["message"])])]),l("div",Fe,[e[28]||(e[28]=l("div",{class:"flex items-start pt-3 w-1/2"},[l("label",{for:"phone"},[V("Phone "),l("sup",{class:"text-red-600"},"*")])],-1)),l("div",Ze,[s(n(x),{invalid:!!((v=a.value)!=null&&v.phone),modelValue:i.value.phone,"onUpdate:modelValue":e[6]||(e[6]=t=>i.value.phone=t),onInput:e[7]||(e[7]=t=>c("phone")),type:"text",id:"phone",class:"w-full"},null,8,["invalid","modelValue"]),s(f,{message:(r=a.value)==null?void 0:r.phone},null,8,["message"])])]),l("div",Te,[e[29]||(e[29]=l("div",{class:"flex items-start pt-3 w-1/2"},[l("label",{for:"addressLine1"},[V("Address Line 1 "),l("sup",{class:"text-red-600"},"*")])],-1)),l("div",Pe,[s(n(x),{invalid:!!((L=a.value)!=null&&L.addressLine1),modelValue:i.value.addressLine1,"onUpdate:modelValue":e[8]||(e[8]=t=>i.value.addressLine1=t),onInput:e[9]||(e[9]=t=>c("addressLine1")),type:"text",id:"addressLine1",class:"w-full"},null,8,["invalid","modelValue"]),s(f,{message:(M=a.value)==null?void 0:M.addressLine1},null,8,["message"])])]),l("div",je,[e[30]||(e[30]=l("div",{class:"flex items-start pt-3 w-1/2"},[l("label",{for:"addressLine2"},"Address Line 2")],-1)),l("div",Re,[s(n(x),{invalid:!!((J=a.value)!=null&&J.addressLine2),modelValue:i.value.addressLine2,"onUpdate:modelValue":e[10]||(e[10]=t=>i.value.addressLine2=t),onInput:e[11]||(e[11]=t=>c("addressLine2")),type:"text",id:"addressLine2",class:"w-full"},null,8,["invalid","modelValue"]),s(f,{message:(O=a.value)==null?void 0:O.addressLine2},null,8,["message"])])]),l("div",Je,[e[31]||(e[31]=l("div",{class:"flex items-start pt-3 w-1/2"},[l("label",{for:"city"},[V("City "),l("sup",{class:"text-red-600"},"*")])],-1)),l("div",Oe,[s(n(x),{invalid:!!((W=a.value)!=null&&W.city),modelValue:i.value.city,"onUpdate:modelValue":e[12]||(e[12]=t=>i.value.city=t),onInput:e[13]||(e[13]=t=>c("city")),type:"text",id:"city",class:"w-full"},null,8,["invalid","modelValue"]),s(f,{message:(G=a.value)==null?void 0:G.city},null,8,["message"])])]),l("div",We,[e[32]||(e[32]=l("div",{class:"flex items-start pt-3 w-1/2"},[l("label",{for:"country"},[V("Country "),l("sup",{class:"text-red-600"},"*")])],-1)),l("div",Ge,[s(n(x),{invalid:!!((K=a.value)!=null&&K.country),modelValue:i.value.country,"onUpdate:modelValue":e[14]||(e[14]=t=>i.value.country=t),onInput:e[15]||(e[15]=t=>c("country")),type:"text",id:"country",class:"w-full"},null,8,["invalid","modelValue"]),s(f,{message:(Q=a.value)==null?void 0:Q.country},null,8,["message"])])]),l("div",Ke,[e[33]||(e[33]=l("div",{class:"flex items-start pt-3 w-1/2"},[l("label",{for:"state"},[V("State "),l("sup",{class:"text-red-600"},"*")])],-1)),l("div",Qe,[s(n(x),{invalid:!!((X=a.value)!=null&&X.state),modelValue:i.value.state,"onUpdate:modelValue":e[16]||(e[16]=t=>i.value.state=t),onInput:e[17]||(e[17]=t=>c("state")),type:"text",id:"state",class:"w-full"},null,8,["invalid","modelValue"]),s(f,{message:(Y=a.value)==null?void 0:Y.state},null,8,["message"])])]),l("div",Xe,[e[34]||(e[34]=l("div",{class:"flex items-start pt-3 w-1/2"},[l("label",{for:"zip"},[V("Zip "),l("sup",{class:"text-red-600"},"*")])],-1)),l("div",Ye,[s(n(x),{invalid:!!((ee=a.value)!=null&&ee.zip),modelValue:i.value.zip,"onUpdate:modelValue":e[18]||(e[18]=t=>i.value.zip=t),onInput:e[19]||(e[19]=t=>c("zip")),type:"text",id:"zip",class:"w-full"},null,8,["invalid","modelValue"]),s(f,{message:(le=a.value)==null?void 0:le.zip},null,8,["message"])])]),l("div",el,[e[35]||(e[35]=l("div",{class:"flex items-start pt-3 w-1/2"},[l("label",{for:"additional"},"Additional info")],-1)),l("div",ll,[s(n(be),{invalid:!!((se=a.value)!=null&&se.additional),modelValue:i.value.additional,"onUpdate:modelValue":e[20]||(e[20]=t=>i.value.additional=t),onInput:e[21]||(e[21]=t=>c("additional")),id:"additional",class:"w-full"},null,8,["invalid","modelValue"]),s(f,{message:(ae=a.value)==null?void 0:ae.additional},null,8,["message"])])]),l("div",sl,[e[36]||(e[36]=l("div",{class:"flex items-start pt-3 w-1/2"},[l("label",{for:"residenceCard"},"Residence card")],-1)),l("div",null,[s(n(de),{severity:"secondary",mode:"basic",name:"residenceCard[]",url:"/api/upload",accept:"image/*",maxFileSize:1e6,onUpload:U,auto:!0,chooseLabel:"Browse"}),s(f,{message:(te=a.value)==null?void 0:te.residenceCard},null,8,["message"])])]),l("div",al,[e[37]||(e[37]=l("div",{class:"flex items-start pt-3 w-1/2"},[l("label",{for:"driveLicense"},"Drive license")],-1)),l("div",null,[s(n(de),{mode:"basic",severity:"secondary",name:"driveLicense[]",url:"/api/upload",accept:"image/*",maxFileSize:1e6,onUpload:U,auto:!0,chooseLabel:"Browse"}),s(f,{message:(ie=a.value)==null?void 0:ie.driveLicense},null,8,["message"])])]),l("div",tl,[e[38]||(e[38]=l("div",{class:"flex items-start pt-3 w-1/2"},[l("label",{for:"points"},"Points")],-1)),l("div",il,[s(n(x),{invalid:!!((ne=a.value)!=null&&ne.points),modelValue:i.value.points,"onUpdate:modelValue":e[22]||(e[22]=t=>i.value.points=t),onInput:e[23]||(e[23]=t=>c("points")),type:"number",id:"points",class:"w-full"},null,8,["invalid","modelValue"]),s(f,{message:(oe=a.value)==null?void 0:oe.points},null,8,["message"])])]),l("div",nl,[s(I,{label:"Cancel",onClick:z,outlined:"",severity:"secondary"}),s(I,{label:"Save",type:"submit",severity:"primary",autofocus:""})])],544)]}),_:1},8,["header","visible"]))}},dl={class:"page page-clients"},rl={class:"page-content"},ul={class:"clients-table"},vl={class:"module module-with-scroller module-with-scroller-lg p-1"},ml={class:"page-content-top mb-3 pb-1 flex gap-2 flex-wrap"},cl={class:"flex"},pl={class:"flex flex-col"},fl={class:"text-muted"},gl={class:"flex gap-2"},yl={class:"page-content-bottom"},_l={__name:"ClientsView",setup(w){const u=g(""),m=g(!1),y=g(!1),C=g(null),d=g([]),i=g([]),S=g(8),q=g(0),A=g(0),a=g(!0),c=({page:o,rows:v})=>{A.value=o,S.value=v,$()},P=o=>{u.value=o,$()},z=o=>{C.value=o,y.value=!0},U=()=>{C.value=null,y.value=!1},p=()=>{d!=null&&d.value.length?H():E(C.value),U()},e=o=>{C.value=o,m.value=!0},h=()=>{m.value=!1},B=o=>{F.upsertClient(o),h(),$()},H=()=>{const o=d.value.map(v=>v.id);F.deleteClients(o),d.value=[],$()},E=o=>{const{id:v}=o;F.deleteClient(v),$()},$=async()=>{a.value=!0;try{const o=await F.getClients({expression:u==null?void 0:u.value},null,A.value,S.value);if(!o.ok)throw new Error("Failed to load data");i.value=o.data,q.value=o.total}catch(o){o.value=o.message}finally{a.value=!1}};return fe(()=>{$()}),(o,v)=>(_(),T("div",dl,[s(ge,{title:"Clients"}),l("div",rl,[l("div",ul,[s(n(xe),null,{content:D(()=>[l("div",vl,[l("div",ml,[s(ye,{variant:"dark",placeholder:"Search for client",onSearchInput:P,filter:u.value},null,8,["filter"]),d.value.length?(_(),k(I,{key:0,severity:"secondary",label:"Delete selected",size:"small",class:"ml-auto delete-selected-clients",onClick:z})):j("",!0),s(I,{label:"Add client",severity:"primary",size:"small",onClick:v[0]||(v[0]=r=>e()),class:Ce([d.value.length?"ml-0":"ml-auto","add-new-client"])},null,8,["class"])]),u.value.length&&!i.value.length?(_(),k(n($e),{key:0,severity:"secondary",class:"w-full mt-5 mb-5"},{default:D(()=>v[2]||(v[2]=[V("No clients were found matching your criteria.")])),_:1})):(_(),k(n(we),{key:1,class:"outlined",scrollable:"",selection:d.value,"onUpdate:selection":v[1]||(v[1]=r=>d.value=r),value:i.value,loading:a.value,tableStyle:"min-width: 50rem"},{default:D(()=>[s(n(N),{selectionMode:"multiple",headerStyle:"width: 3rem"}),s(n(N),{field:"fullname",sortable:"",header:"Client"},{body:D(r=>[l("div",cl,[s(qe,{name:r.data.fullname},null,8,["name"]),l("div",pl,[l("div",null,Z(r.data.fullname),1),l("span",fl,Z(r.data.email),1)])])]),_:1}),s(n(N),{field:"phone",sortable:"",header:"Phone"}),s(n(N),{field:"addressLine1",sortable:"",header:"Address"}),s(n(N),{header:"Documents"},{body:D(r=>{var L,M;return[(L=r.data)!=null&&L.residenceCard?(_(),k(ue,{key:0,class:"my-1","card-type":"residenceCard",firstName:r.data.firstName},null,8,["firstName"])):j("",!0),(M=r.data)!=null&&M.driveLicense?(_(),k(ue,{key:1,class:"my-1","card-type":"driveLicense",firstName:r.data.firstName},null,8,["firstName"])):j("",!0)]}),_:1}),s(n(N),{field:"points",sortable:"",header:"Points"}),s(n(N),{header:"Actions"},{body:D(r=>[l("div",gl,[s(I,{size:"small",label:"Edit",outlined:"",onClick:L=>e(r.data)},null,8,["onClick"]),s(I,{size:"small",label:"Delete",outlined:"",onClick:L=>z(r.data)},null,8,["onClick"])])]),_:1})]),_:1},8,["selection","value","loading"])),l("div",yl,[s(he,{limit:S.value,total:q.value,onPageChange:c},null,8,["limit","total"])])])]),_:1})])]),s(Ve,{showDialog:y.value,onApplyConfirmation:p,onHide:U},null,8,["showDialog"]),s(ol,{client:C.value,showDialog:m.value,onSave:B,onHide:h},null,8,["client","showDialog"])]))}};export{_l as default};
